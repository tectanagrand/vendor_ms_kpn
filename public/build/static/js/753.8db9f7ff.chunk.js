"use strict";(self.webpackChunkui_vms=self.webpackChunkui_vms||[]).push([[753],{4677:function(e,t,n){n.d(t,{j:function(){return r}});var r=n(1243).Z.create({baseURL:"/api",withCredentials:!0})},1124:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(4165),i=n(5861),a=n(4677),s=n(2791),c=n(1243),o=n(8128),l=n(8329),u=function(){var e=(0,o.k)(),t=e.setAccessToken,n=(e.logOut,function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c.Z.get("".concat("/api","/user/refresh"),{withCredentials:!0});case 3:return n=e.sent,t(n.data.accessToken),e.abrupt("return",n.data.accessToken);case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0),Object.keys(l.Z.get()).map((function(e){l.Z.remove(e)})),setTimeout((function(){window.location.replace("".concat(window.location.hostname,"/login"))}),100);case 13:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}());return n},d=function(){var e=u(),t=(0,o.k)().session;return(0,s.useEffect)((function(){var n=a.j.interceptors.request.use((function(e){return e.headers.Authorization||(e.headers.Authorization="Bearer ".concat(t.accessToken)),e}),(function(e){return Promise.reject(e)})),s=a.j.interceptors.response.use((function(e){return e}),function(){var t=(0,i.Z)((0,r.Z)().mark((function t(n){var i,s,c;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=null===n||void 0===n?void 0:n.config,403!==(null===n||void 0===n||null===(i=n.response)||void 0===i?void 0:i.status)||null!==s&&void 0!==s&&s.sent){t.next=8;break}return s.sent=!0,t.next=5,e();case 5:return c=t.sent,s.headers.Authorization="Bearer ".concat(c),t.abrupt("return",(0,a.j)(s));case 8:return t.abrupt("return",Promise.reject(n));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());return function(){a.j.interceptors.request.eject(n),a.j.interceptors.response.eject(s)}}),[t,e]),a.j}},7753:function(e,t,n){n.r(t),n.d(t,{default:function(){return H}});var r=n(1413),i=n(4165),a=n(5861),s=n(9439),c=n(5486),o=n(68),l=n(890),u=n(3400),d=n(4554),h=n(8096),x=n(8406),f=n(3786),p=n(6151),Z=n(7047),v=n(1098),k=n(3208),m=n(5527),j=n(2739),w=n(3239),C=n(1124),g=n(2791),b=n(3439),_=n(4223),y=n(184),E=(0,_.Z)((0,y.jsx)("path",{d:"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"}),"Link"),I=(0,_.Z)((0,y.jsx)("path",{d:"M21 10.12h-6.78l2.74-2.82c-2.73-2.7-7.15-2.8-9.88-.1-2.73 2.71-2.73 7.08 0 9.79s7.15 2.71 9.88 0C18.32 15.65 19 14.08 19 12.1h2c0 1.98-.88 4.55-2.64 6.29-3.51 3.48-9.21 3.48-12.72 0-3.5-3.47-3.53-9.11-.02-12.58s9.14-3.47 12.65 0L21 3v7.12zM12.5 8v4.25l3.5 2.08-.72 1.21L11 13V8h1.5z"}),"Update"),N=n(3710),T=n(5397),A=n(8820),F=(n(8329),n(5574)),S=n(4925),V=n(7196),R=n(3466),z=n(8128),D=n(7689),L=n(9709);function M(e){var t=e.open,n=e.onClose,r=e.linkUrl,c=e.urlSet,o=e.popUp,x=e.onClick,f=(0,C.Z)(),p=(0,z.k)().session,Z=(0,D.s0)(),v=(0,g.useState)(r),k=(0,s.Z)(v,2),m=k[0],j=k[1],w=(0,g.useState)(!1),b=(0,s.Z)(w,2),_=b[0],I=b[1];(0,g.useEffect)((function(){j(r)}),[r]);var N=function(e){o(e)},T=function(e){return(0,a.Z)((0,i.Z)().mark((function t(){var r,a;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return I(!0),t.prev=1,t.next=4,f.post("/ticket/new",{user_id:p.user_id,to_who:e});case 4:r=t.sent,a=r.data,"VENDOR"===e?c("".concat(location.host,"/").concat(a.data.link)):(n(),Z("../form/".concat(a.data.token))),alert("success"),I(!1),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(1),I(!1),alert(t.t0);case 15:case"end":return t.stop()}}),t,null,[[1,11]])})))},A=function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===navigator.clipboard?x(m):navigator.clipboard.writeText(m),N(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,y.jsx)(F.Z,{open:t,onClose:n,maxWidth:"xl",children:(0,y.jsxs)(d.Z,{sx:{width:800,height:500,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[(0,y.jsx)(l.Z,{sx:{mb:7},variant:"h5",children:"Create New Form Request Ticket"}),(0,y.jsx)(L.Z,{sx:{height:80,width:400,mb:2},onClick:T("VENDOR"),loading:_,children:"By Vendor"}),(0,y.jsx)(L.Z,{sx:{height:80,width:400,my:2},onClick:T("PROC"),loading:_,children:"By User"}),(0,y.jsxs)(h.Z,{sx:{mt:5,mb:1,width:780},variant:"outlined",children:[(0,y.jsx)(S.Z,{htmlFor:"link-url-form-label",children:"Link Form"}),(0,y.jsx)(V.Z,{id:"link-url-form",endAdornment:(0,y.jsx)(R.Z,{position:"end",children:(0,y.jsx)(u.Z,{children:(0,y.jsx)(E,{})})}),label:"Password",value:m,readOnly:!0,onClick:A})]})]})})}var O=(0,n(6934).ZP)(m.Z)((function(){return{width:100,height:40,display:"flex",alignItems:"center",justifyContent:"center",elevation:1}}));function P(e){var t=e.children,n=e.color;return(0,y.jsx)(O,{sx:{backgroundColor:n},children:t})}var U={"& .MuiDataGrid-main":{width:0,minWidth:"95%"}};function q(e){return(0,y.jsx)(o.Z,{title:(0,y.jsx)(l.Z,{children:"Refresh"}),children:(0,y.jsx)(L.Z,{loading:e.isLoading,onClick:function(){e.setRefreshbtn(!0)},sx:e.sx,variant:"contained",children:(0,y.jsx)(b.Z,{})})})}function H(){var e=(0,z.k)(),t=(e.session,e.getPermission),n=(e.logOut,(0,g.useState)()),b=(0,s.Z)(n,2),_=b[0],F=b[1],S=(0,g.useState)(),V=(0,s.Z)(S,2),R=V[0],L=V[1],O=(0,g.useState)(!1),H=(0,s.Z)(O,2),B=H[0],W=H[1],G=(0,g.useState)(""),J=(0,s.Z)(G,2),$=J[0],K=J[1],Q=(0,g.useState)(!1),X=(0,s.Z)(Q,2),Y=X[0],ee=X[1],te=(0,g.useState)(!1),ne=(0,s.Z)(te,2),re=(ne[0],ne[1]),ie=(0,g.useState)(null),ae=(0,s.Z)(ie,2),se=ae[0],ce=ae[1],oe=(0,g.useState)(!1),le=(0,s.Z)(oe,2),ue=le[0],de=le[1],he=(0,g.useState)(!0),xe=(0,s.Z)(he,2),fe=xe[0],pe=xe[1],Ze=(0,g.useState)(!1),ve=(0,s.Z)(Ze,2),ke=ve[0],me=ve[1],je=(0,g.useState)([]),we=(0,s.Z)(je,2),Ce=we[0],ge=we[1],be=(0,g.useState)(!0),_e=(0,s.Z)(be,2),ye=_e[0],Ee=_e[1],Ie=(0,C.Z)(),Ne=(0,D.s0)(),Te=function(){var e=(0,a.Z)((0,i.Z)().mark((function e(n){var r,a,s,c,o,l,u,d;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r={}).INIT=t("Initial Form"),r.CREA=t("Creation Form"),r.FINA=t("Final Form"),e.prev=4,o=[],null!==(a=r.INIT)&&void 0!==a&&a.read&&o.push("'INIT'"),null!==(s=r.CREA)&&void 0!==s&&s.read&&o.push("'CREA'"),null!==(c=r.FINA)&&void 0!==c&&c.read&&o.push("'FINA'"),ge(o),e.next=12,Ie.get("/ticket/?is_active=".concat(fe,"&ticket_state=").concat(0===Ce.length?o.join(","):Ce.join(",")),{signal:n.signal});case 12:l=e.sent,u=l.data.data,d=u.data.map((function(e){return{id:e.token,is_active:e.is_active,ticket_num:e.ticket_id,date_ticket:new Date(e.created_at),assignee:e.email,cur_pos:e.cur_pos,status_ticket:e.status_ticket,vendor_name:e.name_1,vendor_code:e.ven_code,ticket_state:e.ticket_state,is_expired:e.is_expired}})),L(d),ye&&Ee(!1),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(4),console.error(e.t0);case 22:case"end":return e.stop()}}),e,null,[[4,19]])})));return function(t){return e.apply(this,arguments)}}();(0,g.useEffect)((function(){var e=new AbortController;ye&&Te(e)}),[$,fe,ke,ye]),(0,g.useEffect)((function(){var e={};e.Table=t("Ticket Request"),e.INIT=t("Initial Form"),e.CREA=t("Creation Form"),e.FINA=t("Final Form"),F(e)}),[]);var Ae=function(){return function(){ee(!1)}},Fe=function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=document.createElement("textarea")).value=t.toString(),n.style.position="absolute",n.style.left="-999999px",n.tabIndex="-1",document.body.appendChild(n),n.select(),n.focus();try{document.execCommand("copy")}catch(r){console.error(r)}finally{n.remove()}case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Se=function(e,t){return function(){var n=(0,a.Z)((0,i.Z)().mark((function n(r){var a,s,c,o;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,"Link"!==e){n.next=14;break}if(void 0!==navigator.clipboard){n.next=7;break}return n.next=5,Fe("".concat(location.host,"/frm/newform/").concat(t.id));case 5:n.next=8;break;case 7:navigator.clipboard.writeText("".concat(location.host,"/frm/newform/").concat(t.id));case 8:ce(r.target),ee(!0),re(!0),setTimeout((function(){ee(!1)}),1e3),n.next=51;break;case 14:if("Delete"!==e){n.next=23;break}return n.next=17,Ie.delete("/ticket/".concat(t.id));case 17:a=n.sent,me(!ke),Ee(!0),alert("Ticket ".concat(a.data.data," is deleted")),n.next=51;break;case 23:if("Extend"!==e){n.next=32;break}if(!confirm("Are you sure want to extend ? (+1 day)")){n.next=30;break}return n.next=27,Ie.post("/ticket/extexp",{ticket_id:t.id});case 27:s=n.sent,alert("Ticket ".concat(s.data.ticket_num," expiry date extended")),Ee(!0);case 30:n.next=51;break;case 32:if("RESEND"!==e){n.next=49;break}if(!confirm("Are you sure want to resend request to CEO ?")){n.next=47;break}return n.prev=34,n.next=37,Ie.post("/ticket/resendceo",{ticket_id:t.id});case 37:n.sent,alert("Ticket resent"),n.next=44;break;case 41:n.prev=41,n.t0=n.catch(34),alert(null===(c=n.t0.response)||void 0===c||null===(o=c.data)||void 0===o?void 0:o.message);case 44:return n.prev=44,Ee(!0),n.finish(44);case 47:n.next=51;break;case 49:Ne("../form/".concat(t.id),{relative:"path"}),de(!0);case 51:n.next=56;break;case 53:n.prev=53,n.t1=n.catch(0),console.error(n.t1);case 56:case"end":return n.stop()}}),n,null,[[0,53],[34,41,44,47]])})));return function(e){return n.apply(this,arguments)}}()},Ve=[{field:"ticket_num",type:"string",headerName:"Ticket Number",flex:.124},{field:"date_ticket",type:"date",flex:.1,headerName:"Date"},{field:"assignee",type:"string",flex:.18,headerName:"Assignee"},{field:"vendor_name",type:"string",flex:.2,headerName:"Vendor Name"},{field:"vendor_code",type:"string",flex:.15,headerName:"Vendor Code"},{field:"cur_pos",type:"string",flex:.1,headerName:"Position"},{field:"status_ticket",type:"string",flex:.123,headerName:"Status",renderCell:function(e){var t,n,r=e.row.status_ticket;return"ON PROCESS"===r?(t="warning.main",n="black"):"REJECT"===r?(t="error.main",n="white"):"ACCEPTED"===r&&(t="success.main",n="white"),(0,y.jsx)(y.Fragment,{children:(0,y.jsx)(P,{color:t,children:(0,y.jsx)(l.Z,{color:n,variant:"body",children:r})})})}},{field:"action",flex:.1,type:"actions",renderCell:function(e){var t=[];return 1==e.row.is_active?("INIT"==e.row.ticket_state&&(_.INIT.create?(t.push((0,y.jsx)(o.Z,{title:"Link",children:(0,y.jsx)(u.Z,{onClick:Se("Link",e.row),onClose:Ae,children:(0,y.jsx)(E,{})})},e.id)),e.row.is_expired&&t.push((0,y.jsx)(o.Z,{title:"Extend Expiry",children:(0,y.jsx)(u.Z,{onClick:Se("Extend",e.row),children:(0,y.jsx)(I,{})})},e.id))):_.INIT.read&&t.push((0,y.jsx)(o.Z,{title:"View",children:(0,y.jsx)(u.Z,{onClick:Se("View",e.row),onClose:Ae,children:(0,y.jsx)(N.Z,{})})},e.id)),_.INIT.delete&&t.push((0,y.jsx)(o.Z,{title:"Delete",children:(0,y.jsx)(u.Z,{onClick:Se("Delete",e.row),onClose:Ae,children:(0,y.jsx)(T.Z,{})})},e.id+"_delete"))),"CREA"==e.row.ticket_state&&(_.CREA.update?t.push((0,y.jsx)(o.Z,{title:"Edit",children:(0,y.jsx)(u.Z,{onClick:Se("Edit",e.row),children:(0,y.jsx)(A.Z,{})})},e.id)):_.CREA.read&&t.push((0,y.jsx)(o.Z,{title:"View",children:(0,y.jsx)(u.Z,{onClick:Se("View",e.row),onClose:Ae,children:(0,y.jsx)(N.Z,{})})},e.id))),"FINA"==e.row.ticket_state&&(_.FINA.update&&"CEO"!==e.row.cur_pos?t.push((0,y.jsx)(o.Z,{title:"Edit",children:(0,y.jsx)(u.Z,{onClick:Se("Edit",e.row),children:(0,y.jsx)(A.Z,{})})},e.id)):_.FINA.read&&t.push((0,y.jsx)(o.Z,{title:"View",children:(0,y.jsx)(u.Z,{onClick:Se("View",e.row),onClose:Ae,children:(0,y.jsx)(N.Z,{})})},e.id)))):t.push((0,y.jsx)(o.Z,{title:"View",children:(0,y.jsx)(u.Z,{onClick:Se("View",e.row),onClose:Ae,children:(0,y.jsx)(N.Z,{})})},e.id)),t}}];return(0,y.jsxs)(y.Fragment,{children:[void 0!==R?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(d.Z,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,y.jsxs)(d.Z,{sx:{display:"flex",gap:2},children:[(0,y.jsx)(h.Z,{children:(0,y.jsxs)(x.Z,{sx:{width:"10em"},id:"filterAct",value:fe,onChange:function(e){pe(!fe),Ee(!0)},children:[(0,y.jsx)(f.Z,{value:!0,children:"Active"}),(0,y.jsx)(f.Z,{value:!1,children:"Inactive"})]})}),(0,y.jsx)(q,{setRefreshbtn:function(){Ee(!0)},isLoading:ye,sx:{mb:3,height:"3.5rem"}})]}),_.Table.create&&(0,y.jsx)(p.Z,{variant:"contained",sx:{width:180,height:50,my:2},onClick:function(){W(!0)},children:"Create New Vendor"})]}),(0,y.jsx)(c._$,{sx:U,rows:R,columns:Ve,disableColumnFilter:!0,disableColumnSelector:!0,disableDensitySelector:!0})]}):(0,y.jsxs)(d.Z,{children:[(0,y.jsx)(Z.Z,{animation:"wave",height:100}),(0,y.jsx)(Z.Z,{animation:"wave",height:100}),(0,y.jsx)(Z.Z,{animation:"wave",height:100}),(0,y.jsx)(Z.Z,{animation:"wave",height:100}),(0,y.jsx)(Z.Z,{animation:"wave",height:100})]}),(0,y.jsx)(M,{open:B,onClose:function(){W(!1),K("")},linkUrl:$,urlSet:function(e){K(e),Ee(!0)},popUp:function(e){ce(e.target),ee(!0),re(!0),setTimeout((function(){ee(!1)}),1e3)},onClick:Fe}),(0,y.jsx)(v.Z,{open:Y,anchorEl:se,transition:!0,sx:{zIndex:3e3},children:function(e){var t=e.TransitionProps;return(0,y.jsx)(k.Z,(0,r.Z)((0,r.Z)({},t),{},{in:Y,timeout:350,children:(0,y.jsx)(m.Z,{sx:{border:1,p:1,bgcolor:"background.paper"},children:"Link Form Copied !"})}))}}),(0,y.jsx)(j.Z,{sx:{color:"#fff",zIndex:function(e){return e.zIndex.drawer-2}},open:ue,children:(0,y.jsx)(w.Z,{color:"inherit"})})]})}},5397:function(e,t,n){var r=n(4223),i=n(184);t.Z=(0,r.Z)((0,i.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete")},8820:function(e,t,n){var r=n(4223),i=n(184);t.Z=(0,r.Z)((0,i.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Edit")},3710:function(e,t,n){var r=n(4223),i=n(184);t.Z=(0,r.Z)((0,i.jsx)("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"}),"Visibility")}}]);
//# sourceMappingURL=753.8db9f7ff.chunk.js.map