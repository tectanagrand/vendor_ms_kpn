"use strict";(self.webpackChunkui_vms=self.webpackChunkui_vms||[]).push([[538],{4677:function(e,t,n){n.d(t,{j:function(){return r}});var r=n(1243).Z.create({baseURL:"/api",withCredentials:!0})},6467:function(e,t,n){n.d(t,{Z:function(){return A}});var r=n(9439),a=n(4554),i=n(9281),c=n(9836),s=n(6890),o=n(5855),l=n(3994),u=n(3382),d=n(890),x=n(8582),h=n(3157),f=n(558),p=n(1235),Z=n(318),j=n(9384),v=n(8820),m=n(3400),g=n(68),k=n(6125),w=n(8550),b=n(2791),C=n(184);function y(e){var t=e.row,n=e.length,a=e.button,i=e.setAction,c=(0,b.useState)(!1),s=(0,r.Z)(c,2),u=s[0],x=s[1],h=function(e,t){i(e,t)},y=0;return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(o.Z,{children:["details"in t&&(0,C.jsx)(l.Z,{children:(0,C.jsx)(m.Z,{onClick:function(){x(!u)},children:u?(0,C.jsx)(f.Z,{}):(0,C.jsx)(p.Z,{})})}),Object.keys(t).map((function(e){if("details"!=e&&"id"!=e)return(0,C.jsx)(l.Z,{align:"left",children:t[e]},"".concat(y++,"-cell"))})),(0,C.jsx)(l.Z,{children:0!=a.length&&a.map((function(e){switch(e){case"accept":return(0,C.jsx)(g.Z,{title:(0,C.jsx)(d.Z,{children:e}),children:(0,C.jsx)(m.Z,{sx:{backgroundColor:"#4ef542",mx:1},onClick:function(){return h(e,t.id)},children:(0,C.jsx)(Z.Z,{})})},"".concat(e,"-").concat(y++));case"reject":case"deactive":return(0,C.jsx)(g.Z,{title:(0,C.jsx)(d.Z,{children:e}),children:(0,C.jsx)(m.Z,{sx:{backgroundColor:"#f2573f",mx:1},onClick:function(){return h(e,t.id)},children:(0,C.jsx)(j.Z,{})})},"".concat(e,"-").concat(y++));case"edit":return(0,C.jsx)(g.Z,{title:(0,C.jsx)(d.Z,{children:e}),children:(0,C.jsx)(m.Z,{sx:{backgroundColor:"primary.light",mx:1},onClick:function(){return h(e,t.id)},children:(0,C.jsx)(v.Z,{})})},"".concat(e,"-").concat(y++))}}))})]}),(0,C.jsx)(o.Z,{children:(0,C.jsx)(l.Z,{colSpan:n,sx:{padding:0,margin:0},children:(0,C.jsxs)(k.Z,{in:u,timeout:"auto",unmountOnExit:!0,children:[(0,C.jsx)(d.Z,{variant:"h6",sx:{mx:2,my:2},children:"Details"}),(0,C.jsx)(w.Z,{inputProps:{readOnly:!0},multiline:!0,value:t.details,fullWidth:!0,sx:{px:4}})]})})})]})}var S=n(5009);function A(e){var t=e.data,n=e.header,f=e.buttons,p=e.lengthRow,Z=e.onAction,j=function(e,t){Z(e,t)},v=(0,b.useState)(t),m=(0,r.Z)(v,2),g=m[0],k=m[1],w=(0,b.useState)(""),A=(0,r.Z)(w,2),N=A[0],P=A[1],_=(0,b.useState)(0),E=(0,r.Z)(_,2),O=E[0],z=E[1],M=(0,b.useState)(5),F=(0,r.Z)(M,2),T=F[0],U=(F[1],(0,b.useState)(0)),D=(0,r.Z)(U,2),H=D[0],R=D[1];(0,b.useEffect)((function(){R(Math.max(0,T-g.slice(O*T,O*T+T).length))}),[]),(0,b.useEffect)((function(){k(t),R(Math.max(0,T-t.slice(O*T,O*T+T).length))}),[t]);var L=function(e){var n=t.filter((function(t){var n=!1;return Object.values(t).map((function(t){null!==t&&t.toString().toLowerCase().includes(e.toString().toLowerCase())&&(n=!0)})),n}));k(n)},V=0;return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(a.Z,{sx:{display:"flex",justifyContent:"flex-end",margin:1},children:(0,C.jsx)(S.Z,{value:N,onChange:L,onCancelResearch:function(){P(""),L(N)},onSearch:function(e){return P(e)}})}),(0,C.jsx)(i.Z,{sx:{maxHeight:440},children:(0,C.jsxs)(c.Z,{stickyHeader:!0,"aria-label":"sticky table",children:[(0,C.jsx)(s.Z,{children:(0,C.jsxs)(o.Z,{children:[0!=t.length&&"details"in t[0]&&(0,C.jsx)(l.Z,{children:"details"},"details"),n.map((function(e){return(0,C.jsx)(l.Z,{children:e},e)})),0!=f.length&&(0,C.jsx)(l.Z,{},"buttons")]})}),(0,C.jsxs)(u.Z,{children:[0!=t.length&&(T>0?g.slice(O*T,O*T+T):g).map((function(e){return(0,C.jsx)(y,{row:e,length:p,button:f,setAction:j},"".concat(V++))})),H>0&&0!=t.length&&(0,C.jsx)(o.Z,{style:{height:74.5*H},children:(0,C.jsx)(l.Z,{colSpan:p})}),0==t.length&&(0,C.jsx)(o.Z,{style:{height:74.5*H},children:(0,C.jsx)(l.Z,{colSpan:p,children:(0,C.jsx)(d.Z,{variant:"h5",sx:{textAlign:"center"},children:"Empty Data"})})})]})]})}),(0,C.jsxs)(c.Z,{children:[(0,C.jsx)(s.Z,{}),(0,C.jsx)(u.Z,{}),(0,C.jsx)(x.Z,{children:(0,C.jsx)(o.Z,{children:(0,C.jsx)(h.Z,{rowsPerPageOptions:[5,10,25,{label:"All",value:-1}],colSpan:p,count:g.length,rowsPerPage:T,page:O,SelectProps:{inputProps:{"aria-label":"rows per page"},native:!0},onPageChange:function(e,t){z((function(e){return R(t>0?Math.max(0,T-g.slice(t*T,t*T+T).length):0),t}))}})})})]})]})}},1124:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(4165),a=n(5861),i=n(4677),c=n(2791),s=n(1243),o=n(8128),l=n(8329),u=function(){var e=(0,o.k)(),t=e.setAccessToken,n=(e.logOut,function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.Z.get("".concat("/api","/user/refresh"),{withCredentials:!0});case 3:return n=e.sent,t(n.data.accessToken),e.abrupt("return",n.data.accessToken);case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0),Object.keys(l.Z.get()).map((function(e){l.Z.remove(e)})),setTimeout((function(){window.location.replace("".concat(window.location.hostname,"/login"))}),100);case 13:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}());return n},d=function(){var e=u(),t=(0,o.k)().session;return(0,c.useEffect)((function(){var n=i.j.interceptors.request.use((function(e){return e.headers.Authorization||(e.headers.Authorization="Bearer ".concat(t.accessToken)),e}),(function(e){return Promise.reject(e)})),c=i.j.interceptors.response.use((function(e){return e}),function(){var t=(0,a.Z)((0,r.Z)().mark((function t(n){var a,c,s;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c=null===n||void 0===n?void 0:n.config,403!==(null===n||void 0===n||null===(a=n.response)||void 0===a?void 0:a.status)||null!==c&&void 0!==c&&c.sent){t.next=8;break}return c.sent=!0,t.next=5,e();case 5:return s=t.sent,c.headers.Authorization="Bearer ".concat(s),t.abrupt("return",(0,i.j)(c));case 8:return t.abrupt("return",Promise.reject(n));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());return function(){i.j.interceptors.request.eject(n),i.j.interceptors.response.eject(c)}}),[t,e]),i.j}},9588:function(e,t,n){n.r(t),n.d(t,{default:function(){return g}});var r=n(4165),a=n(5861),i=n(9439),c=(n(6467),n(2791)),s=n(68),o=n(890),l=n(3400),u=n(4554),d=n(6151),x=n(8820),h=n(9384),f=n(4223),p=n(184),Z=(0,f.Z)((0,p.jsx)("path",{d:"M17 1.01 7 1c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V3c0-1.1-.9-1.99-2-1.99zM17 19H7V5h10v14zm-1-6h-3V8h-2v5H8l4 4 4-4z"}),"SystemUpdate"),j=n(7689),v=n(5486),m=n(1124);function g(){var e=(0,m.Z)(),t=(0,c.useState)(0),n=(0,i.Z)(t,2),f=(n[0],n[1]),g=(0,c.useState)(),k=(0,i.Z)(g,2),w=k[0],b=k[1],C=(0,c.useState)(!1),y=(0,i.Z)(C,2),S=y[0],A=y[1],N=(0,j.s0)();(0,c.useEffect)((function(){var t=function(){var t=(0,a.Z)((0,r.Z)().mark((function t(){var n;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.get("/user/");case 2:n=t.sent,b(n.data.data),f(Object.entries(n.data.data[0]).length),A(!1);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t()}),[S]);var P=function(){var t=(0,a.Z)((0,r.Z)().mark((function t(n,a){var i,c;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(A(!0),"edit"!==n){t.next=5;break}N({pathname:"./create",search:"?iduser=".concat(a.id)},{state:{page:"user"}}),t.next=35;break;case 5:if("deactivate"!==n){t.next=21;break}if(!confirm("are you sure want to deactivate ?")){t.next=19;break}return t.prev=7,t.next=10,e.post("/user/updatestat",{id:a.id,role:a.role,is_active:!1});case 10:i=t.sent,alert("".concat(i.data.message)),A(!1),t.next=19;break;case 15:t.prev=15,t.t0=t.catch(7),alert("".concat(t.t0.response.data.message)),A(!1);case 19:t.next=35;break;case 21:if("activate"!==n){t.next=35;break}if(!confirm("are you sure want to activate ?")){t.next=35;break}return t.prev=23,t.next=26,e.post("/user/updatestat",{id:a.id,role:a.role,is_active:!0});case 26:c=t.sent,alert("".concat(c.data.message)),A(!1),t.next=35;break;case 31:t.prev=31,t.t1=t.catch(23),alert("".concat(t.t1.response.data.message)),A(!1);case 35:case"end":return t.stop()}}),t,null,[[7,15],[23,31]])})));return function(e,n){return t.apply(this,arguments)}}(),_=[{field:"fullname",headerName:"Full Name",flex:.1},{field:"username",headerName:"Username",flex:.1},{field:"email",headerName:"Email",flex:.1},{field:"user_group_name",headerName:"User Group",flex:.05},{field:"role",headerName:"Role",flex:.05},{field:"created_at",headerName:"Created At",flex:.05},{field:"expired_date",headerName:"Expired Date",flex:.05},{headerName:"Action",flex:.1,renderCell:function(e){var t=e.row.is_active,n=[];return n.push((0,p.jsx)(s.Z,{title:(0,p.jsx)(o.Z,{children:"Edit"}),children:(0,p.jsx)(l.Z,{sx:{backgroundColor:"primary.light",mx:1},onClick:function(){return P("edit",{id:e.row.id})},children:(0,p.jsx)(x.Z,{})})})),t?n.push((0,p.jsx)(s.Z,{title:(0,p.jsx)(o.Z,{children:"Deactivate"}),children:(0,p.jsx)(l.Z,{sx:{backgroundColor:"#f2573f",mx:1},onClick:function(){return P("deactivate",{id:e.row.id,role:e.row.role})},children:(0,p.jsx)(h.Z,{})})})):n.push((0,p.jsx)(s.Z,{title:(0,p.jsx)(o.Z,{children:"Activate"}),children:(0,p.jsx)(l.Z,{sx:{backgroundColor:"#4ef542",mx:1},onClick:function(){return P("activate",{id:e.row.id,role:e.row.role})},children:(0,p.jsx)(Z,{})})})),n}}];return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(u.Z,{sx:{display:"flex",justifyContent:"flex-end"},children:(0,p.jsx)(d.Z,{sx:{width:200,heigth:50,margin:2},variant:"contained",onClick:function(){N("./create")},children:(0,p.jsx)(o.Z,{children:"Create New User"})})}),void 0!=w?(0,p.jsx)(v._$,{rows:w,columns:_,initialState:{pagination:{paginationModel:{pageSize:5}}}}):(0,p.jsx)(p.Fragment,{})]})}}}]);
//# sourceMappingURL=538.ca8f89a3.chunk.js.map