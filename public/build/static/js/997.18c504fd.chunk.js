"use strict";(self.webpackChunkui_vms=self.webpackChunkui_vms||[]).push([[997],{4677:function(e,n,r){r.d(n,{j:function(){return t}});var t=r(1243).Z.create({baseURL:"/api",withCredentials:!0})},204:function(e,n,r){r.d(n,{$:function(){return o}});var t=r(8550),a=r(9195),u=r(184),o=function(e){var n=e.control,r=e.label,o=e.name,c=e.rules,s=e.valueovr,i=e.readOnly,f=e.onChangeovr,d=e.toUpperCase,l=e.toLowerCase,p=e.helperText;return(0,u.jsx)(u.Fragment,{children:(0,u.jsx)(a.Qr,{name:o,control:n,rules:c,defaultValue:s,render:function(e){var n=e.field,a=n.onChange,o=n.value,c=n.ref,s=e.fieldState.error;return(0,u.jsx)(t.Z,{helperText:s?s.message:p,error:!!s,onChange:function(e){a(d?e.target.value.toUpperCase():l?e.target.value.toLowerCase():e)},onBlur:function(e){void 0!==f&&f(e.target.value)},inputRef:c,value:o,label:r,variant:"outlined",inputProps:{readOnly:i},fullWidth:!0})}})})}},1124:function(e,n,r){r.d(n,{Z:function(){return d}});var t=r(4165),a=r(5861),u=r(4677),o=r(2791),c=r(1243),s=r(8128),i=r(8329),f=function(){var e=(0,s.k)(),n=e.setAccessToken,r=(e.logOut,function(){var e=(0,a.Z)((0,t.Z)().mark((function e(){var r;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c.Z.get("".concat("/api","/user/refresh"),{withCredentials:!0});case 3:return r=e.sent,n(r.data.accessToken),e.abrupt("return",r.data.accessToken);case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0),Object.keys(i.Z.get()).map((function(e){i.Z.remove(e)})),setTimeout((function(){window.location.replace("".concat(window.location.hostname,"/login"))}),100);case 13:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}());return r},d=function(){var e=f(),n=(0,s.k)().session;return(0,o.useEffect)((function(){var r=u.j.interceptors.request.use((function(e){return e.headers.Authorization||(e.headers.Authorization="Bearer ".concat(n.accessToken)),e}),(function(e){return Promise.reject(e)})),o=u.j.interceptors.response.use((function(e){return e}),function(){var n=(0,a.Z)((0,t.Z)().mark((function n(r){var a,o,c;return(0,t.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=null===r||void 0===r?void 0:r.config,403!==(null===r||void 0===r||null===(a=r.response)||void 0===a?void 0:a.status)||null!==o&&void 0!==o&&o.sent){n.next=8;break}return o.sent=!0,n.next=5,e();case 5:return c=n.sent,o.headers.Authorization="Bearer ".concat(c),n.abrupt("return",(0,u.j)(o));case 8:return n.abrupt("return",Promise.reject(r));case 9:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}());return function(){u.j.interceptors.request.eject(r),u.j.interceptors.response.eject(o)}}),[n,e]),u.j}},2997:function(e,n,r){r.r(n),r.d(n,{default:function(){return C}});var t=r(4165),a=r(4942),u=r(1413),o=r(5861),c=r(9439),s=r(9164),i=r(890),f=r(1889),d=r(4554),l=r(4454),p=r(5486),v=r(2791),h=r(184);function m(e){var n=e.data,r=e.onChange,t=(0,v.useState)([{id:"",name:"",fcreate:!1,fread:!1,fupdate:!1,fdelete:!1}]),o=(0,c.Z)(t,2),s=o[0],i=o[1];(0,v.useEffect)((function(){var e=n.map((function(e){return(0,u.Z)((0,u.Z)({},e),{},{id:e.id})}));i(e)}),[n]);var f=function(e,n){return function(r){var t=s.map((function(r){return r.id===e?(0,u.Z)((0,u.Z)({},r),{},(0,a.Z)({},n,!r[n])):(0,u.Z)({},r)}));i(t)}};(0,v.useEffect)((function(){var e=[];s.map((function(n){var r=!0;Object.keys(n).map((function(t){["fcreate","fupdate","fread","fdelete"].includes(t)&&n[t]&&r&&(r=!1,e.push(n))}))})),r(e)}),[s]);var d=[{field:"page",headerName:"Menu Name",type:"string",flex:.3},{field:"fcreate",headerName:"Create",renderCell:function(e){var n=e.id,r=e.row;return(0,h.jsx)(l.Z,{checked:r.fcreate,onClick:f(n,"fcreate")})},flex:.1},{field:"fread",headerName:"Read",renderCell:function(e){var n=e.id,r=e.row;return(0,h.jsx)(l.Z,{checked:r.fread,onClick:f(n,"fread")})},flex:.1},{field:"fupdate",headerName:"Update",renderCell:function(e){var n=e.id,r=e.row;return(0,h.jsx)(l.Z,{checked:r.fupdate,onClick:f(n,"fupdate")})},flex:.1},{field:"fdelete",headerName:"Delete",renderCell:function(e){var n=e.id,r=e.row;return(0,h.jsx)(l.Z,{checked:r.fdelete,onClick:f(n,"fdelete")})},flex:.1}];return(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(p._$,{rows:s,columns:d,sx:{height:500}})})}var x=r(204),Z=r(9195),g=r(1087),j=r(1124),k=r(8128),w=r(9709);function C(){var e=(0,j.Z)(),n=[],r=(0,v.useState)(!1),l=(0,c.Z)(r,2),p=l[0],C=l[1],b=(0,g.lr)(),y=(0,c.Z)(b,1)[0],S=(0,k.k)(),N=S.session,T=S.setSession,P=(0,Z.cI)({defaultValues:{groupname:""}}),A=P.handleSubmit,O=P.control,U=P.reset,z=function(){var r=(0,o.Z)((0,t.Z)().mark((function r(c){var s,i;return(0,t.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return C(!0),s={groupname:c.groupname,groupid:$||"",accessmtx:n},i=function(){var n=(0,o.Z)((0,t.Z)().mark((function n(){var r;return(0,t.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.post("/user/authorization",{group_id:N.groupid});case 2:r=n.sent,T((0,u.Z)((0,u.Z)({},N),{},(0,a.Z)({},"permission",r.data)));case 4:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),r.prev=3,r.next=6,e.post("/user/secmtx/submit",s);case 6:r.sent,i(),alert("Updated success"),C(!1),r.next=16;break;case 12:r.prev=12,r.t0=r.catch(3),C(!1),alert(r.t0);case 16:case"end":return r.stop()}}),r,null,[[3,12]])})));return function(e){return r.apply(this,arguments)}}(),E=(0,v.useState)([]),_=(0,c.Z)(E,2),B=_[0],L=_[1],R=B,$=y.get("idgroup");return(0,v.useEffect)((function(){var n=function(){var n=(0,o.Z)((0,t.Z)().mark((function n(){var r;return(0,t.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.post("/user/secmtx",{groupid:$||""});case 2:r=n.sent,U({groupname:r.data.name}),L(r.data.data);case 5:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();n()}),[]),(0,h.jsx)(s.Z,{children:(0,h.jsxs)("form",{onSubmit:A(z),children:[(0,h.jsx)(i.Z,{variant:"h4",children:"Menu Access Permission"}),(0,h.jsx)(f.ZP,{container:!0,xs:!0,children:(0,h.jsx)(f.ZP,{item:!0,xs:6,children:(0,h.jsx)(x.$,{name:"groupname",control:O,label:"Group Name"})})}),(0,h.jsx)(m,{data:R,onChange:function(e){n=e}}),(0,h.jsx)(d.Z,{sx:{display:"flex",justifyContent:"flex-end"},children:(0,h.jsx)(w.Z,{variant:"contained",type:"submit",sx:{padding:2,margin:2},loading:p,children:(0,h.jsx)(i.Z,{children:"Submit"})})})]})})}}}]);
//# sourceMappingURL=997.18c504fd.chunk.js.map