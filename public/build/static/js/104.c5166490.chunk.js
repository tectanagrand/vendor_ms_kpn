"use strict";(self.webpackChunkui_vms=self.webpackChunkui_vms||[]).push([[104],{4677:function(e,r,n){n.d(r,{j:function(){return t}});var t=n(1243).Z.create({baseURL:"/api",withCredentials:!0})},5143:function(e,r,n){n.d(r,{r:function(){return v}});var t=n(9439),a=n(9569),s=n(3710),u=n(8096),o=n(4925),i=n(7196),l=n(3466),c=n(3400),d=n(9195),f=n(2791),p=n(184),v=function(e){var r=e.control,n=e.label,v=e.name,m=e.rules,x=(0,f.useState)(!1),h=(0,t.Z)(x,2),Z=h[0],g=h[1],j=function(){return g((function(e){return!e}))},b=function(e){e.preventDefault()};return(0,p.jsx)(p.Fragment,{children:(0,p.jsx)(d.Qr,{name:v,control:r,rules:m,render:function(e){var r=e.field,t=r.onChange,d=r.value,f=e.fieldState.error;return(0,p.jsxs)(u.Z,{fullWidth:!0,variant:"outlined",children:[(0,p.jsx)(o.Z,{htmlFor:"outlined-adornment-password",children:n}),(0,p.jsx)(i.Z,{id:"outlined-adornment-password",type:Z?"text":"password",onChange:t,value:d,error:f,inputProps:{autoComplete:"new-password"},endAdornment:(0,p.jsx)(l.Z,{position:"end",children:(0,p.jsx)(c.Z,{"aria-label":"toggle password visibility",onClick:j,onMouseDown:b,edge:"end",children:Z?(0,p.jsx)(a.Z,{}):(0,p.jsx)(s.Z,{})})}),label:n})]})}})})}},8592:function(e,r,n){n.d(r,{Z:function(){return c}});var t=n(3786),a=n(8096),s=n(4925),u=n(8406),o=n(7071),i=n(9195),l=n(184);function c(e){var r=e.name,n=e.control,c=e.label,d=e.options,f=e.onChangeovr,p=e.rules,v=e.disabled,m=e.readOnly,x=e.valueovr;return(0,l.jsx)(a.Z,{fullWidth:!0,disabled:v,children:(0,l.jsx)(i.Qr,{render:function(e){var r=e.field,n=r.onChange,a=r.value,i=r.ref,p=e.fieldState.error;return v&&(a=""),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.Z,{error:!!p,children:c}),(0,l.jsx)(u.Z,{fullWidth:!0,error:!!p,label:c,value:a,inputRef:i,inputProps:{readOnly:m,disabled:v},onChange:function(e){n(e),void 0!=f&&f(e.target.value)},children:d.map((function(e){return(0,l.jsx)(t.Z,{value:e.value,children:e.label},e.value)}))}),(0,l.jsx)(o.Z,{error:!!p,children:null===p||void 0===p?void 0:p.message})]})},control:n,name:r,rules:p,defaultValue:x})})}},204:function(e,r,n){n.d(r,{$:function(){return u}});var t=n(8550),a=n(9195),s=n(184),u=function(e){var r=e.control,n=e.label,u=e.name,o=e.rules,i=e.valueovr,l=e.readOnly,c=e.onChangeovr,d=e.toUpperCase,f=e.toLowerCase,p=e.helperText;return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(a.Qr,{name:u,control:r,rules:o,defaultValue:i,render:function(e){var r=e.field,a=r.onChange,u=r.value,o=r.ref,i=e.fieldState.error;return(0,s.jsx)(t.Z,{helperText:i?i.message:p,error:!!i,onChange:function(e){a(d?e.target.value.toUpperCase():f?e.target.value.toLowerCase():e)},onBlur:function(e){void 0!==c&&c(e.target.value)},inputRef:o,value:u,label:n,variant:"outlined",inputProps:{readOnly:l},fullWidth:!0})}})})}},1124:function(e,r,n){n.d(r,{Z:function(){return d}});var t=n(4165),a=n(5861),s=n(4677),u=n(2791),o=n(1243),i=n(8128),l=n(8329),c=function(){var e=(0,i.k)(),r=e.setAccessToken,n=(e.logOut,function(){var e=(0,a.Z)((0,t.Z)().mark((function e(){var n;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.Z.get("".concat("/api","/user/refresh"),{withCredentials:!0});case 3:return n=e.sent,r(n.data.accessToken),e.abrupt("return",n.data.accessToken);case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0),Object.keys(l.Z.get()).map((function(e){l.Z.remove(e)})),setTimeout((function(){window.location.replace("".concat(window.location.hostname,"/login"))}),100);case 13:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}());return n},d=function(){var e=c(),r=(0,i.k)().session;return(0,u.useEffect)((function(){var n=s.j.interceptors.request.use((function(e){return e.headers.Authorization||(e.headers.Authorization="Bearer ".concat(r.accessToken)),e}),(function(e){return Promise.reject(e)})),u=s.j.interceptors.response.use((function(e){return e}),function(){var r=(0,a.Z)((0,t.Z)().mark((function r(n){var a,u,o;return(0,t.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(u=null===n||void 0===n?void 0:n.config,403!==(null===n||void 0===n||null===(a=n.response)||void 0===a?void 0:a.status)||null!==u&&void 0!==u&&u.sent){r.next=8;break}return u.sent=!0,r.next=5,e();case 5:return o=r.sent,u.headers.Authorization="Bearer ".concat(o),r.abrupt("return",(0,s.j)(u));case 8:return r.abrupt("return",Promise.reject(n));case 9:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}());return function(){s.j.interceptors.request.eject(n),s.j.interceptors.response.eject(u)}}),[r,e]),s.j}},6104:function(e,r,n){n.r(r),n.d(r,{default:function(){return P}});var t=n(4165),a=n(5861),s=n(9439),u=n(9164),o=n(4554),i=n(890),l=n(1889),c=n(8592),d=n(204),f=n(5143),p=n(9195),v=n(2791),m=n(1124),x=n(7892),h=n.n(x),Z=n(1812),g=n(1652),j=n(4750),b=n(184);function w(e){var r=e.name,n=e.label,t=e.control,a=e.rules;return(0,b.jsx)(g._,{dateAdapter:j.y,children:(0,b.jsx)(p.Qr,{control:t,name:r,rules:a,render:function(e){var r=e.field,t=r.onChange,a=r.value,s=e.fieldState.error;return(0,b.jsx)(Z.M,{sx:{width:"100%"},onChange:t,value:h()(a),label:n,slotProps:{textField:{error:!!s,helperText:null===s||void 0===s?void 0:s.message}}})}})})}var k=n(7689),C=n(1087),Y=n(9709),y=n(8128);function P(){var e,r,n=(0,v.useState)(!1),x=(0,s.Z)(n,2),Z=x[0],g=x[1],j=(0,k.TH)(),P=(0,m.Z)(),D=(0,C.lr)(),M=(0,s.Z)(D,1)[0],_=(0,v.useState)(""),S=(0,s.Z)(_,2),q=S[0],U=S[1],T=(0,y.k)(),E=T.session,F=T.getPermission,A=F("User").update,O=(0,k.s0)(),R=(0,p.cI)({mode:"onChange",defaultValues:{manager:"",fullname:"",username:"",usergroup:"",email:"",password:"",role:"",datecreated:h()().format("MM/DD/YYYY"),expireddate:h()().format("MM/DD/YYYY")},resetOptions:{keepDirtyValues:!0,keepErrors:!0}}),Q=R.handleSubmit,V=R.control,W=R.reset,$=R.getFieldState,z=(R.formState.isDirty,function(){var e=(0,a.Z)((0,t.Z)().mark((function e(r){var n,a;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.get("/user/show/?iduser=".concat(r));case 2:n=e.sent,void 0!=(a=n.data.data)&&(U(a.user_id),"MGR"===a.role&&ue(!0),W({manager:a.mgr_id,fullname:a.fullname,username:a.username,usergroup:a.usergroup,email:a.email,role:a.role,datecreated:h()(a.datecreated).format("MM/DD/YYYY"),expireddate:h()(a.expireddate).format("MM/DD/YYYY")}));case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()),B=(0,v.useState)([{value:"",label:""}]),G=(0,s.Z)(B,2),L=G[0],I=G[1],H=(0,v.useState)([{value:"",label:""}]),N=(0,s.Z)(H,2),J=N[0],K=N[1],X=(0,v.useState)([{value:"",label:""}]),ee=(0,s.Z)(X,2),re=ee[0],ne=ee[1],te=(0,v.useState)(!1),ae=(0,s.Z)(te,2),se=ae[0],ue=ae[1];(0,v.useEffect)((function(){var e=function(){var e=(0,a.Z)((0,t.Z)().mark((function e(){var r,n;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P.get("/user/lssecmtx");case 3:r=e.sent,n=r.data.data.map((function(e){return{value:e.user_group_id,label:e.user_group_name}})),I(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),alert(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();e()}),[]),(0,v.useEffect)((function(){var e=function(){var e=(0,a.Z)((0,t.Z)().mark((function e(){var r,n;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P.get("/user/roles");case 3:r=e.sent,n=r.data.data.map((function(e){return{value:e.id_role,label:e.role}})),K(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),alert(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();e()}),[]),(0,v.useEffect)((function(){var e=function(){var e=(0,a.Z)((0,t.Z)().mark((function e(){var r,n;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P.get("/user/mgrs");case 3:r=e.sent,n=r.data.data.map((function(e){return{value:e.mgr_id,label:e.fullname}})),ne(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),alert(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();e()}),[]),(0,v.useEffect)((function(){var e=M.get("iduser");F("User").update||M.get("iduser")===E.user_id||(e=E.user_id),z(e)}),[j.state]);var oe=function(){var e=(0,a.Z)((0,t.Z)().mark((function e(r){var n,a,s;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g(!0),n=se?"":r.manager,a={user_id:q,mgr_id:n,fullname:r.fullname,username:r.username,usergroup:r.usergroup,email:r.email,role:r.role,createddate:h()(r.datecreated).format("MM/DD/YYYY"),expireddate:h()(r.expireddate).format("MM/DD/YYYY")},$("password").isDirty&&(a.password=r.password),e.prev=4,e.next=7,P.post("/user/submit",a);case 7:s=e.sent,g(!1),alert(s.data.message),F("User").update?O("../users"):O("../ticket"),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(4),g(!1),alert(e.t0);case 17:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(r){return e.apply(this,arguments)}}();return F("User").update||M.get("iduser")===E.user_id?(0,b.jsx)(u.Z,{children:(0,b.jsxs)("form",{onSubmit:Q(oe),children:[(0,b.jsxs)(o.Z,{sx:{display:"flex",flexDirection:"column",gap:2,width:"100%"},children:[(0,b.jsx)(i.Z,{variant:"h4",sx:{textAlign:"center",pb:5},children:"User Information"}),A&&"userinfo"!==(null===(e=j.state)||void 0===e?void 0:e.page)&&(0,b.jsxs)(l.ZP,{container:!0,spacing:2,children:[(0,b.jsx)(l.ZP,{item:!0,xs:!0,children:(0,b.jsx)(w,{label:"Date Created",name:"datecreated",control:V,rules:{required:!0}})}),(0,b.jsx)(l.ZP,{item:!0,xs:!0,children:(0,b.jsx)(w,{label:"Expired Date",name:"expireddate",control:V,rules:{required:!0}})})]}),(0,b.jsxs)(l.ZP,{container:!0,spacing:2,children:[(0,b.jsx)(l.ZP,{item:!0,xs:!0,children:(0,b.jsx)(d.$,{name:"username",control:V,label:"Username",rules:{required:!0}})}),(0,b.jsx)(l.ZP,{item:!0,xs:!0,children:(0,b.jsx)(f.r,{name:"password",control:V,label:"Password",rules:{required:""==q}})})]}),(0,b.jsxs)(l.ZP,{container:!0,spacing:2,children:[(0,b.jsx)(l.ZP,{item:!0,xs:!0,children:(0,b.jsx)(d.$,{name:"fullname",control:V,label:"Full Name",rules:{required:!0}})}),(0,b.jsx)(l.ZP,{item:!0,xs:!0,children:(0,b.jsx)(d.$,{name:"email",control:V,label:"Email",rules:{required:!0}})})]}),A&&"userinfo"!==(null===(r=j.state)||void 0===r?void 0:r.page)&&(0,b.jsxs)(l.ZP,{container:!0,spacing:2,children:[(0,b.jsx)(l.ZP,{item:!0,xs:6,children:(0,b.jsx)(c.Z,{name:"usergroup",control:V,label:"User Group",options:L,rules:{required:!0}})}),(0,b.jsx)(l.ZP,{item:!0,xs:6,children:(0,b.jsx)(c.Z,{name:"role",control:V,label:"Role",options:J,rules:{required:!0},onChangeovr:function(e){ue("MGR"===e)}})}),(0,b.jsx)(l.ZP,{item:!0,xs:6,children:(0,b.jsx)(c.Z,{name:"manager",control:V,label:"Manager",options:re,disabled:se})})]})]}),(0,b.jsx)(o.Z,{sx:{display:"flex",justifyContent:"flex-end",mt:10},children:(0,b.jsx)(Y.Z,{type:"submit",sx:{width:100,height:50},variant:"contained",loading:Z,children:(0,b.jsx)(i.Z,{children:"Save"})})})]})}):(0,b.jsx)(k.Fg,{to:"../../dashboard/account/edit?iduser=".concat(E.user_id)})}}}]);
//# sourceMappingURL=104.c5166490.chunk.js.map